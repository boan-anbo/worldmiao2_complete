{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/BookAccesses.vue?1e16","webpack:///./src/components/VueBook.vue?bcd2","webpack:///./src/components/SearchBox.vue?aa68","webpack:///./src/workers/upshelf.worker.js","webpack:///./src/components/Library.vue?a0cd","webpack:///./src/App.vue","webpack:///./src/entities/book.entity.ts","webpack:///./src/components/Library.vue","webpack:///./src/entities/book.fetch.entity.ts","webpack:///./src/components/VueBook.vue","webpack:///./src/functions/fetchBookAccess.ts","webpack:///./src/components/BookAccesses.vue","webpack:///./src/components/BookAccesses.vue?1315","webpack:///./src/components/VueBook.vue?2736","webpack:///./src/entities/app.entity.ts","webpack:///./src/components/Library.vue?ea27","webpack:///./src/components/SearchBox.vue","webpack:///./src/components/SearchBox.vue?ef01","webpack:///./src/components/SearchStatusPanel.vue","webpack:///./src/components/SearchStatusPanel.vue?f6a4","webpack:///./src/App.vue?47b3","webpack:///./src/App.vue?8ecf","webpack:///./src/main.ts","webpack:///./src/App.vue?da25","webpack:///./src/components/SearchStatusPanel.vue?b19b","webpack:///./src/workers/upshelf.worker.js?9332"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","wrap","class","style","id","bookProviderList","provider","providerIndex","bookStore","providerEnum","library-name","providerName","colIsEven","book-provider","library-url","url","being-maintained","beingMaintained","showAllLibraryBoxes","holdings","library-index","search-box","searchInputMinLength","onSearchRequest","search-all","state","searchAll","onSearchAll","searchTerm","search-status","closeBookshelfHandler","shelfIsEmpty","searchStore","onReuseSearchTerm","type","maxlength","suggestionContent","onSuggestionInputFocused","suggestionFocused","placeholder","suggestionSent","makeSuggestion","BookProvider","BookDataType","BookAccessType","BookProviderList","ZLIBRARY","WORLD_CAT","GOOGLE_BOOKS","GUTENBERG","LIBRARY_GENESIS","PROLETARIAT","MEMORY_OF_THE_WORLD","OPEN_LIBRARY","uniqueId","title","pages","subtitle","description","author","publicationYear","isbns","publisher","format","thumbnail","emptyBook","access","this","uniqueIdentifier","idNote","openLink","libraryUrl","libraryName","showBoxes","searchStatusShown","hideBoxes","bookShelfRef","bookProvider","bookShelfBox","index","boxesShown","fetchResultRepository","bookCoverShown","book","onReceiveFetchRequest","BookAccessFetchingState","toggleBookInfo","showInfo","fetchStatus","accesses","links","identifier","bookAccess","FETCHING","console","log","interval","setInterval","timer","setTimeout","FETCHED","clearInterval","getStatusString","getAccessTypeString","link","openWindow","getDisplayString","props","Array","String","methods","open","accessType","string","DATABASE","toLowerCase","computed","QUEUING","dataType","render","components","BookAccesses","emits","setup","IDLE","fetch","test","Number","Boolean","fetchTimer","fetchResultRepositorySub","undefined","resetAllProperties","hasNeedToFetch","onFetchAccess","Error","makeFetchRequest","bookId","$emit","mounted","subscribe","operation","status","unmounted","unsubscribe","watch","LibrarySearchStatus","searchedTerm","searchResultCount","_searchingStatus","intervalTimer","searchTimer","term","toFixed","count","searchingStatus","stopTimer","ERROR","SEARCHING","resetTimer","startTimer","SEARCH_FINISHED","VueBook","books","bookShelf","fillBookShelfWithEmptyBoxes","bookShelfBoxes","showOneBookCover","getThisShelfToSet","hideOneBookCover","unshelfBooks","upshelfBooks","booksLength","forEach","bookToLoad","bookIndex","v4","showAllBookCover","hideAllBookCover","showBookCover","hideBookCover","getThisShelf","libraryIndex","searchAllRequestSub","pipe","delay","fetchRequestQueueSub","fetchRequestQueue","concatMap","isBookIdValid","updateFetchResultRepoWithStatus","payload","axios","post","filter","val","res","updateFetchResultRepoWithResult","Subject","findIndex","box","next","makeSearchRequest","emitSearchTermChanges","$event","target","isInputTooShort","isRequestValid","checked","toggleSearchAll","hideSearchButton","searchDeboucerSub","merge","requestEmitter","first","skip","debounce","grayOutSearch","localSearchString","trim","clearInput","inputIsEmpty","searchAllChecked","requestWatcher","getSearchTerm","reuseSearchTerm","getCurrentStatus","librarySearchStatus","getSearchResultCount","getSearchTime","closeBookShelf","getTimerValue","statusString","getSearchedTerm","replace","libraryOrder","currentSearchAllRequestId","globalProvider","sendSearchRequest","uniqueSearchAllRequestId","providerEntry","setSearchStatus","setSearchTerm","revivedBooks","map","item","assign","setSearchResultCount","searchStatus","getSearchStatus","setSearchedTerm","isSearchAllChecked","content","Library","SearchBox","SearchStatusPanel","App","use","mount","Worker"],"mappings":"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","file":"js/app.bda643fa.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./BookAccesses.vue?vue&type=style&index=0&id=21022ed4&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./VueBook.vue?vue&type=style&index=0&id=25178b2b&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./SearchBox.vue?vue&type=style&index=0&id=ee7545b8&lang=css\"","module.exports = require('comlink').wrap(require(\"!worker-loader?{}!C:/Script/worldmiao2_complete/worldmiao2/node_modules/comlink-loader/dist/comlink-worker-loader.js!C:\\\\Script\\\\worldmiao2_complete\\\\worldmiao2\\\\node_modules\\\\cache-loader\\\\dist\\\\cjs.js??ref--13-0!C:\\\\Script\\\\worldmiao2_complete\\\\worldmiao2\\\\node_modules\\\\thread-loader\\\\dist\\\\cjs.js!C:\\\\Script\\\\worldmiao2_complete\\\\worldmiao2\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Script\\\\worldmiao2_complete\\\\worldmiao2\\\\node_modules\\\\eslint-loader\\\\index.js??ref--14-0!C:\\\\Script\\\\worldmiao2_complete\\\\worldmiao2\\\\src\\\\workers\\\\upshelf.worker.js\")());module.exports.__esModule = true;","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Library.vue?vue&type=style&index=0&id=8ee0a016&lang=css\"","<template>\r\n  <div class=\"bg-gray-700 px-4 truncate text-white text-lg text-center sm:text-right pr-8\" style=\"font-family: 'Iceland', sans-serif; background-color: #5D8D89\" >\r\n<!--  noti  -->\r\n   <span class=\"sm:inline hidden\"> worldmiao.two | </span>\r\n    <span class=\"text-xs\"> 世界喵兔 </span>\r\n    <span class=\"inline\">| ebook search engine</span>\r\n  </div>\r\n\r\n  <div\r\n      id=\"main-panel-layout\"\r\n\r\n      class=\"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-4 2xl:grid-cols-4 4xl:grid-cols-8\"\r\n  >\r\n  <div\r\n        v-for=\"(provider, providerIndex) in bookProviderList\"\r\n        :key=\"providerIndex\"\r\n  >\r\n\r\n\r\n          <Library\r\n            :bookStore=\"bookStore[provider.providerEnum]\" :library-name=\"provider.providerName\" :colIsEven=\"providerIndex % 2 === 0\" :book-provider=\"provider.providerEnum\" :library-url=\"provider.url\"\r\n            :being-maintained=\"provider.beingMaintained\"\r\n            :showAllLibraryBoxes=\"showAllLibraryBoxes\"\r\n            :holdings=\"provider.holdings\"\r\n            :library-index=\"providerIndex\"\r\n          >\r\n\r\n        <template v-slot:search-box>\r\n\r\n<!--       Panel for showing search box. pass down to library as slot. -->\r\n          <SearchBox\r\n              class=\"static\"\r\n              :searchInputMinLength=\"searchInputMinLength\"\r\n              :book-provider=\"provider.providerEnum\"\r\n              @search-request=\"onSearchRequest\"\r\n              :search-all=\"state.searchAll\"\r\n              @on-search-all=\"onSearchAll\"\r\n              v-model:searchTerm=\"state.searchTerm\"/>\r\n        </template>\r\n  <!--      Provide searching status-->\r\n        <template   v-slot:search-status=\"{\r\n          closeBookshelfHandler,\r\n          shelfIsEmpty\r\n        }\"\r\n        >\r\n<!--     Pnale for showing results. pass down to Library.   -->\r\n          <SearchStatusPanel\r\n              @close-bookshelf=\"closeBookshelfHandler\"\r\n              :shelfIsEmpty=\"shelfIsEmpty\"\r\n              :book-provider=\"provider.providerEnum\" :bookStore=\"bookStore\" :searchStore=\"searchStore\"\r\n              @reuse-search-term=\"onReuseSearchTerm\"\r\n          />\r\n        </template>\r\n\r\n</Library>\r\n</div>\r\n</div>\r\n<div class=\" bg-gray-700  text-white text-lg px-4\" style=\"font-family: 'Iceland', sans-serif; background-color: #5D8D89\" >\r\n\r\n  <div class=\" w-full\">\r\n\r\n<!--        <span>suggestion</span>-->\r\n    <input type=\"text\"\r\n           maxlength=\"300\"\r\n           v-model=\"suggestionContent\"\r\n           @focus=\"onSuggestionInputFocused\"\r\n           @blur=\"suggestionFocused = false\"\r\n           :class=\"{\r\n             'hover:underline': this.suggestionFocused === false && this.suggestionSent === false && this.suggestionContent.length === 0,\r\n           'text-center': this.suggestionContent.length === 0,\r\n           'cursor-pointer': this.suggestionFocused === false,\r\n           'border-b': this.suggestionFocused === true,\r\n           }\"\r\n           class=\"text-base px-1 outline-none   placeholder-gray-100 text-center \"\r\n           style=\"background: #5D8D89;  min-width: 100px; width: 250px\"\r\n           :placeholder=\"this.suggestionFocused ? '' : ( this.suggestionSent ? 'thank you for contributing.' : 'click to add links, bugs, & suggestions.')\" />\r\n    <span v-if=\"suggestionFocused || suggestionContent.length > 0\" @click=\"makeSuggestion()\" @keyup.enter=\"makeSuggestion()\" class=\"  pl-2\">\r\n      <span :class=\"{ 'text-gray-400' : suggestionContent.length === 0 }\" class=\"cursor-pointer hover:underline\">submit</span>\r\n    </span>\r\n  </div>\r\n  <div class=\"text-center text-base  sm:inline sm:col-span-1\"> (bo an 2020)</div>\r\n</div>\r\n\r\n\r\n</template>\r\n\r\n\r\n<script lang=\"ts\">\r\n\r\n\r\nimport {Book, BookProvider, BookProviderList} from \"@/entities/book.entity\";\r\nimport {defineComponent} from \"vue\";\r\nimport {reactive} from \"vue\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {AppProps, BookStore} from \"@/interfaces/AppProps\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {ScrapingCenterSuccessResponse} from \"@/interfaces/ScrapingCenterSuccessResponse\";\r\nimport Library from \"@/components/Library.vue\";\r\nimport SearchBox from \"@/components/SearchBox.vue\";\r\nimport SearchStatusPanel from \"@/components/SearchStatusPanel.vue\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {LibrarySearchStatus, SearchStatus, SearchStore} from \"@/entities/app.entity\";\r\nimport { v4 } from 'uuid';\r\nimport { Subject } from 'rxjs'\r\nexport default defineComponent({\r\n  name: 'App',\r\n  setup(){\r\n\r\n    const state = reactive({\r\n      searchTerm: '',\r\n      searchAll: false\r\n\r\n\r\n    } as AppProps);\r\n    const bookProviderList = BookProviderList\r\n    return {\r\n      bookProviderList,\r\n      state\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      suggestionContent: '',\r\n      suggestionSent: false,\r\n      suggestionFocused: false,\r\n      bookProvider: BookProvider,\r\n      libraryOrder: [\r\n      ],\r\n      searchStore: {\r\n        GOOGLE_BOOKS: new SearchStatus(BookProvider.GOOGLE_BOOKS),\r\n        MEMORY_OF_THE_WORLD: new SearchStatus(BookProvider.MEMORY_OF_THE_WORLD),\r\n        LIBRARY_GENESIS: new SearchStatus(BookProvider.LIBRARY_GENESIS),\r\n        OPEN_LIBRARY: new SearchStatus(BookProvider.OPEN_LIBRARY),\r\n        WORLD_CAT: new SearchStatus(BookProvider.WORLD_CAT),\r\n        ZLIBRARY: new SearchStatus(BookProvider.ZLIBRARY),\r\n        GUTENBERG: new SearchStatus(BookProvider.GUTENBERG),\r\n        PROLETARIAT: new SearchStatus(BookProvider.PROLETARIAT),\r\n      } as SearchStore\r\n      ,\r\n      bookStore: {\r\n        GOOGLE_BOOKS: {\r\n          // data: new Array(20)\r\n        },\r\n        MEMORY_OF_THE_WORLD: {},\r\n        LIBRARY_GENESIS: {},\r\n        OPEN_LIBRARY: {},\r\n        WORLD_CAT: {},\r\n        ZLIBRARY: {},\r\n        PROLETARIAT: {},\r\n        GUTENBERG: {}\r\n      } as BookStore\r\n      ,\r\n      showAllLibraryBoxes: new Subject(),\r\n      // to check if the current search all request is updated and drop the old one in the process.\r\n      currentSearchAllRequestId: '',\r\n      searchInputMinLength: 1\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    test() {\r\n      console.log(\"app.vue received close bookshelf\")\r\n    },\r\n    onSearchRequest: async function (globalProvider: BookProvider) {\r\n      // check if need to search all libraries\r\n      if (this.state.searchAll) {\r\n        this.searchAll()\r\n      } else {\r\n        this.sendSearchRequest(globalProvider)\r\n      }\r\n    },\r\n    searchAll: async function() {\r\n      // if so, show all library boxes first\r\n      this.bookProviderList.forEach((provider) => {\r\n        this.showAllLibraryBoxes.next(provider.providerEnum);\r\n      })\r\n\r\n      // generate an uuid for the current search all request, and save it globally;\r\n      const uniqueSearchAllRequestId = v4();\r\n      this.currentSearchAllRequestId = uniqueSearchAllRequestId;\r\n\r\n\r\n      for await (const providerEntry of this.bookProviderList) {\r\n        // when the global current search id doesn't match local search id, break out of the loop.\r\n        if (this.currentSearchAllRequestId !== uniqueSearchAllRequestId) {\r\n          break;\r\n        }\r\n        await this.sendSearchRequest(providerEntry.providerEnum, uniqueSearchAllRequestId)\r\n      }\r\n    }\r\n    ,\r\n    sendSearchRequest: async function(provider: BookProvider, uniqueSearchAllRequestId?: string) {\r\n      const { searchTerm } = this.state;\r\n      // const url = 'https://www.worldmiao.com/api/scraper/'\r\n      const url = './api/scraper';\r\n      // const url = 'http://localhost:9000/scraper';\r\n\r\n      console.log(\"Posting your request for \", provider, 'for term', searchTerm, \" to\", url)\r\n      // update search status\r\n      this.setSearchStatus(provider, LibrarySearchStatus.SEARCHING)\r\n      this.setSearchTerm(provider, searchTerm);\r\n\r\n      // sending http request\r\n      const {data} = await this.axios.post<ScrapingCenterSuccessResponse>(url, {title:searchTerm, provider})\r\n      if (!data) {\r\n        this.setSearchStatus(provider, LibrarySearchStatus.ERROR)\r\n      }\r\n\r\n      console.log(`Received Response From Server for ${provider}, for term ${searchTerm}, data:`, data)\r\n\r\n      if (uniqueSearchAllRequestId && this.currentSearchAllRequestId !== uniqueSearchAllRequestId) {\r\n        console.log('batch search request dropped, drop the fetched data')\r\n        return\r\n      }\r\n\r\n      const revivedBooks = (data as ScrapingCenterSuccessResponse).data.map(item => Object.assign(new Book(provider), item))\r\n      data.data = revivedBooks;\r\n      this.bookStore[provider] = {...data};\r\n\r\n      this.setSearchStatus(provider, LibrarySearchStatus.SEARCH_FINISHED)\r\n      this.setSearchResultCount(provider, data?.data?.length)\r\n      return\r\n    },\r\n    setSearchStatus: function(provider: BookProvider, searchStatus: LibrarySearchStatus)  {\r\n       this.getSearchStatus(provider).setSearchStatus(searchStatus)\r\n    },\r\n\r\n    setSearchTerm: function (provider: BookProvider, searchTerm: string) {\r\n      this.getSearchStatus(provider).setSearchedTerm(searchTerm)\r\n    },\r\n    getSearchStatus: function(provider: BookProvider) {\r\n       return this.searchStore[provider]\r\n    },\r\n    setSearchResultCount: function(provider: BookProvider, count: number) {\r\n\r\n      this.getSearchStatus(provider).setSearchResultCount(count)\r\n    },\r\n    onReuseSearchTerm:function(provider: BookProvider, searchTerm: string) {\r\n\r\n\r\n      console.log('On Reuse Search Term', provider, searchTerm)\r\n      // this.setSearchTerm(provider, searchTerm)\r\n      this.state.searchTerm = searchTerm\r\n    },\r\n    onSearchAll: function(isSearchAllChecked: boolean) {\r\n      console.log('parent received isSearchALl Checked', isSearchAllChecked)\r\n      this.state.searchAll = isSearchAllChecked\r\n    },\r\n    makeSuggestion: async function () {\r\n      if (this.suggestionContent.length > this.searchInputMinLength) {\r\n        // const url = 'http://localhost:9000/suggestion';\r\n        const url = './api/suggestion';\r\n        console.log('sending suggestion to back end', this.suggestionContent, url)\r\n        this.suggestionSent = false\r\n        const res = await this.axios.post(url, {content: this.suggestionContent})\r\n        console.log(res)\r\n        // if suggestion submission is successful\r\n        if (res.status === 201) {\r\n          this.suggestionSent = true\r\n          this.suggestionContent = ''\r\n        }\r\n      }\r\n    },\r\n    onSuggestionInputFocused() {\r\n\r\n        this.suggestionFocused = true\r\n        this.suggestionSent = false\r\n\r\n    }\r\n    },\r\n  components: {\r\n    Library,\r\n    SearchBox,\r\n    SearchStatusPanel\r\n  }\r\n})\r\n</script>\r\n\r\n<style>\r\n\r\n\r\n#app {\r\n\r\n  font-family: Avenir, Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  text-align: center;\r\n  /*color: #2c3e50;*/\r\n\r\n}\r\n</style>\r\n\r\n","export enum BookProvider {\r\n    LIBRARY_GENESIS= 'LIBRARY_GENESIS',\r\n    OPEN_LIBRARY = 'OPEN_LIBRARY',\r\n    GOOGLE_BOOKS = 'GOOGLE_BOOKS',\r\n    WORLD_CAT = 'WORLD_CAT',\r\n    MEMORY_OF_THE_WORLD = 'MEMORY_OF_THE_WORLD',\r\n    ZLIBRARY = 'ZLIBRARY',\r\n    PROLETARIAT = 'PROLETARIAT',\r\n    GUTENBERG = 'GUTENBERG',\r\n}\r\n\r\n// 3 places to update: (1) this provider list (2) bookstore, (3) search store in App.Vue\r\nexport const BookProviderList: { providerName: string, providerEnum: BookProvider, url?: string, beingMaintained: null | string, holdings?: string }[] = [\r\n    {\r\n        providerName: \"Z Library\",\r\n        providerEnum: BookProvider.ZLIBRARY,\r\n        url: 'https://z-lib.org/',\r\n        beingMaintained: null\r\n    },\r\n    {\r\n        providerName: \"eBook Databases\",\r\n        providerEnum: BookProvider.WORLD_CAT,\r\n        url: '',\r\n        // beingMaintained: 'under maintenance. fetch disabled.'\r\n        beingMaintained: null,\r\n        holdings: '320,000 +'\r\n    },\r\n    {\r\n        providerName: \"Google Books\",\r\n        providerEnum:   BookProvider.GOOGLE_BOOKS,\r\n        url: 'https://books.google.com/',\r\n        beingMaintained: null\r\n    },\r\n    {\r\n        providerName: \"Project Gutenberg\",\r\n        providerEnum: BookProvider.GUTENBERG,\r\n        url: 'http://www.gutenberg.org',\r\n        beingMaintained: null,\r\n        holdings: '60,000 +'\r\n    },\r\n    {\r\n        providerName: \"Library Genesis\",\r\n        providerEnum: BookProvider.LIBRARY_GENESIS,\r\n        url: 'http://gen.lib.rus.ec/',\r\n        beingMaintained: null\r\n    },\r\n\r\n\r\n    {\r\n        providerName: \"Proletariat Library\",\r\n        providerEnum: BookProvider.PROLETARIAT,\r\n        url: 'https://library.proletarian.me/',\r\n        beingMaintained: null,\r\n        holdings: '10,000 +'\r\n    },\r\n    {\r\n        providerName: \"Memory of the World\",\r\n        providerEnum:  BookProvider.MEMORY_OF_THE_WORLD,\r\n        url: 'https://library.memoryoftheworld.org/',\r\n        beingMaintained: null,\r\n        holdings: '150,000 +'\r\n    },\r\n    {\r\n        providerName: \"Open Library\",\r\n        providerEnum:BookProvider.OPEN_LIBRARY,\r\n        url: 'http://openlibrary.org/',\r\n        beingMaintained: null,\r\n        holdings: '1,400,000 +'\r\n    },\r\n\r\n\r\n\r\n]\r\n\r\nexport enum BookDataType {\r\n    BOOKS = \"BOOKS\",\r\n    BOOK_ACCESS = \"BOOK_ACCESS\"\r\n}\r\n\r\nexport enum BookAccessType {\r\n    DOWNLOAD= \"DOWNLOAD\",\r\n    BORROW = \"BORROW\",\r\n    PURCHASE = \"PURCHASE\",\r\n    EBOOK = \"EBOOK\",\r\n    DATABASE = 'DATABASE'\r\n}\r\n\r\n\r\nexport interface UniqueId {\r\n    id: string;\r\n    idNote: string;\r\n}\r\n\r\nexport class BookAccess {\r\n    constructor(link: string, type: BookAccessType, name?: string) {\r\n        this.link = link;\r\n        this.type = type;\r\n        this.name = name ?? ''\r\n    }\r\n\r\n    link: string;\r\n\r\n    name = ''\r\n\r\n    id: string = '';\r\n\r\n    type: BookAccessType\r\n}\r\n\r\nexport class Book {\r\n    id: string = ''\r\n    title: string = '';\r\n\r\n    pages: string = '';\r\n\r\n    subtitle: string = '';\r\n\r\n    description: string = '';\r\n\r\n    author: string = ' ';\r\n\r\n    publicationYear: number = 0;\r\n\r\n    isbns: string [] = [];\r\n\r\n    readonly uniqueIdentifier: UniqueId;\r\n\r\n    publisher: string  = '';\r\n\r\n    format: string = '';\r\n\r\n    provider: BookProvider | null\r\n\r\n    thumbnail: string = '';\r\n\r\n    emptyBook = false;\r\n\r\n    constructor(provider: BookProvider | null, uniqueId?: UniqueId, title?: string) {\r\n        this.provider = provider;\r\n        if (provider === null) {\r\n            this.emptyBook = true;\r\n        }\r\n\r\n        this.uniqueIdentifier = uniqueId ?? {id: '', idNote: ''};\r\n        this.title = title ?? '';\r\n    }\r\n\r\n    access: BookAccess[] = [];\r\n}\r\n\r\n","<template>\r\n  <div style=\"max-width: 100%; max-height:200px; height: 200px;\"\r\n\r\n        class=\"search-panel border grid grid-cols-1 content-between\"\r\n       >\r\n\r\n\r\n\r\n<!--    Test load books-->\r\n<!--    <button  @click=\"loadBooks\">Load BOoks</button>-->\r\n      <div class=\"search-header  mt-4 \">\r\n        <span @click.stop.prevent=\"openLink(libraryUrl)\"\r\n              class=\"text-lg  text-black \"\r\n\r\n              style=\"color: #668885\"\r\n        >\r\n          <span class=\"hover:underline cursor-pointer\" :title=\"libraryUrl\">{{libraryName}} </span>\r\n<!--          Maintainance notice -->\r\n        <p v-if=\"beingMaintained !== null\" class=\"hover:no-underline text-xs text-gray-600\">({{beingMaintained}})</p>\r\n\r\n<!--         holdings count -->\r\n          <p class=\"hover:no-underline text-xs cursor-default text-gray-600\">\r\n            <span v-if=\"beingMaintained === null && holdings\" >({{holdings}})</span>\r\n            <span v-if=\"!(beingMaintained === null && holdings)\" >&nbsp;</span>\r\n          </p>\r\n      </span>\r\n\r\n      </div>\r\n\r\n    <div class=\"row-3\"></div>\r\n    <div @click=\"showBoxes\">\r\n      <!--      search button-->\r\n<!--      <button @click=\"showBookCover\">Show Cover</button>-->\r\n<!--      <button @click=\"hideBookCover\">Hide Cover</button>-->\r\n      <slot name=\"search-box\"  ></slot>\r\n\r\n      <!--      search button-->\r\n\r\n    </div>\r\n\r\n\r\n    <div v-if=\"searchStatusShown\">\r\n      <slot\r\n          :closeBookshelfHandler=\"hideBoxes\"\r\n          :shelfIsEmpty=\"shelfIsEmpty()\"\r\n           name=\"search-status\"> </slot>\r\n\r\n    </div>\r\n    <div v-if=\"!searchStatusShown\" class=\"white\">&nbsp;</div>\r\n\r\n  </div>\r\n\r\n  <div\r\n\r\n      id=\"book-shelf\"\r\n      class=\"\r\n      bg-gray-200\r\n      bg-opacity-25\r\n      overflow-hidden\r\n\r\n      \" v-for=\"(bookShelfBox, index) in bookShelfRef[bookProvider]\" :key=\"index\">\r\n\r\n    <VueBook\r\n        class=\"bookBox\"\r\n        :fetchResultRepository=\"fetchResultRepository\"\r\n        :class=\"{'moveUpOutOfView': !boxesShown}\"\r\n        :bookCoverShown=\"bookShelfBox.bookCoverShown\"\r\n        :book=\"bookShelfBox.book\"\r\n        :library-name=\"libraryName\"\r\n        :index=\"index\"\r\n        :beingMaintained=\"beingMaintained\"\r\n        @fetch-request=\"onReceiveFetchRequest\"\r\n    />\r\n\r\n  </div>\r\n\r\n</template>\r\n\r\n<script >\r\n// eslint-disable-next-line no-unused-vars\r\nimport {Book, BookAccess, BookAccessType, BookProvider, BookProviderList} from \"@/entities/book.entity\";\r\n// eslint-disable-next-line no-unused-vars\r\n// eslint-disable-next-line no-unused-vars\r\nimport {LibraryProps} from \"@/interfaces/LibraryProps\";\r\nimport VueBook from \"@/components/VueBook.vue\";\r\nimport {ref} from \"vue\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {BookShelf, BookShelfBox} from \"@/entities/app.entity\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport { Subject, empty } from 'rxjs'\r\n// eslint-disable-next-line no-unused-vars\r\nimport { concatMap, catchError, delay   } from 'rxjs/operators'\r\nimport { v4 } from 'uuid';\r\nimport {filter} from 'rxjs/operators';\r\nimport {BookAccessFetchingState} from \"@/entities/book.fetch.entity\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {getEmptyBookShelfBxoes} from \"@/workers/upshelf.worker\";\r\n\r\n// eslint-disable-next-line no-unused-vars\r\n// const faker = require('faker');\r\nexport default {\r\n  name: 'Library',\r\n  components: {VueBook},\r\n  setup(props) {\r\n\r\n\r\n    // console.log(\"Checking bookstore\", props.bookStore);\r\n\r\n\r\n    // type: Book [];\r\n    let books = ref(new Array(20));\r\n\r\n    // assembly book shelf\r\n    // type: BookShelf\r\n    const bookShelf = {}\r\n\r\n    const bookShelfRef = ref(bookShelf)\r\n\r\n\r\n    const fillBookShelfWithEmptyBoxes = () => {\r\n      console.log('filling empty boxes')\r\n      let bookShelfBoxes = [];\r\n      // for (let i = 0; i < BookProviderList.length; i ++) {\r\n        // give each provider a shelf.\r\n\r\n        for (let i = 0; i < 20; i++) {\r\n          bookShelfBoxes.push(\r\n            // give each shelf box an empty book and a book cover toggle.\r\n            new BookShelfBox()\r\n          )\r\n        }\r\n\r\n      // }\r\n      bookShelfRef.value[props.bookProvider] = bookShelfBoxes\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n    // eslint-disable-next-line no-unused-vars\r\n    const showOneBookCover = (index) => {\r\n      setTimeout(() => getThisShelfToSet()[index].bookCoverShown = true, index * 80)\r\n    }\r\n\r\n    const hideOneBookCover = (index) => {\r\n      setTimeout(() => getThisShelfToSet()[index].bookCoverShown = false, index * 80)\r\n    }\r\n\r\n    const getThisShelfToSet = () => {\r\n      return bookShelfRef.value[props.bookProvider]\r\n    }\r\n\r\n\r\n    const unshelfBooks =() => {\r\n      bookShelfRef.value[props.bookProvider] = []\r\n    }\r\n\r\n    const shelfIsEmpty = () => {\r\n      return bookShelfRef.value[props.bookProvider]?.length === 0;\r\n    }\r\n\r\n    const upshelfBooks = (books) => {\r\n      fillBookShelfWithEmptyBoxes()\r\n\r\n      const booksLength = books?.length\r\n\r\n      if (booksLength > 20) {\r\n        books = books.slice(0, 20);\r\n      }\r\n\r\n\r\n      //\r\n      books.forEach((bookToLoad, bookIndex) => {\r\n        getThisShelfToSet()[bookIndex].book = bookToLoad;\r\n        getThisShelfToSet()[bookIndex].book.id = v4();\r\n        // console.log(\"Old Book: \", getThisShelfToSet()[bookIndex].book, \"new book\", bookToLoad)\r\n        hideOneBookCover(bookIndex);\r\n      })\r\n\r\n      // if (booksLength < 20) {\r\n      // for(let i = booksLength; i < 20; i++)\r\n      //   {\r\n      //     getThisShelfToSet()[i].book = new Book();\r\n      //     // console.log(\"Old Book: \", getThisShelfToSet()[bookIndex].book, \"new book\", bookToLoad)\r\n      //     hideOneBookCover(i);\r\n      //   }\r\n      // }\r\n\r\n\r\n    }\r\n\r\n    // const bookCoverShown = ref(true);\r\n\r\n    const showAllBookCover = () => {\r\n\r\n\r\n      for (let i = 0; i < bookShelfRef.value[props.bookProvider].length; i++) {\r\n        showOneBookCover(i)\r\n\r\n      }\r\n    }\r\n\r\n\r\n    const hideAllBookCover = () => {\r\n      for (let i = 0; i < bookShelfRef.value[props.bookProvider].length; i++) {\r\n       hideOneBookCover(i)\r\n\r\n      }\r\n\r\n    }\r\n\r\n\r\n\r\n    // const  loadTestBooks = () => {\r\n    //   const fakeBooks = []\r\n    //   for (let i = 0; i < 15; i++) {\r\n    //     const newBook = new Book(props.bookProvider, {id: '1', idNote: 'fake ID'}, faker.lorem.sentence(12))\r\n    //     newBook.author = faker.name.findName() + ' ' + faker.name.lastName();\r\n    //     newBook.publicationYear = faker.date.past().getFullYear()\r\n    //     newBook.description = faker.lorem.paragraph();\r\n    //     newBook.access.push(new BookAccess(faker.internet.url(), BookAccessType.DOWNLOAD))\r\n    //     newBook.isbns.push(faker.finance.account())\r\n    //     newBook.isbns.push(faker.finance.account())\r\n    //     newBook.publisher = faker.company.companyName();\r\n    //     newBook.format = 'PDF'\r\n    //     fakeBooks.push(newBook)\r\n    //   }\r\n    //   upshelfBooks(fakeBooks)\r\n    // }\r\n    //\r\n    // loadTestBooks()\r\n\r\n    return {\r\n      books,\r\n      // loadBooks: loadTestBooks,\r\n      showBookCover: showAllBookCover,\r\n      hideBookCover: hideAllBookCover,\r\n      bookShelfRef,\r\n      upshelfBooks,\r\n      unshelfBooks,\r\n      getThisShelf: getThisShelfToSet,\r\n      fillBookShelfWithEmptyBoxes,\r\n      shelfIsEmpty,\r\n    }\r\n  },\r\n  props: {\r\n    libraryName: String,\r\n    bookProvider: BookProvider,\r\n    colIsEven: Boolean,\r\n    bookStore: Object,\r\n    libraryUrl: String,\r\n    beingMaintained: String,\r\n    holdings: String,\r\n    showAllLibraryBoxes: Object,\r\n    libraryIndex: Number\r\n  },\r\n  mounted() {\r\n    //start subscribing to showall library boxes. when it emit values, show the boxes\r\n    this.searchAllRequestSub = this.showAllLibraryBoxes?.pipe(delay(100)).subscribe((providerEnum) => {\r\n      // received a request to show all book boxes\r\n      // console.log('received the cmd to show boxes')\r\n      if (providerEnum === this.bookProvider) {\r\n      this.showBoxes()\r\n      }\r\n\r\n    })\r\n\r\n    // start subscribing to the pipe. the pipe uses concat Map to steamline multiple http requests into a sequence of requests so the server is not overloaded. it sends http requests one after another. and when it comes the time to send the request, it will check again if the request book id still exists. if it exists, proceed with sending the request. otherwise, cancel and wait for the next order.\r\n    this.fetchRequestQueueSub = this.fetchRequestQueue\r\n        .pipe(\r\n            concatMap(async({index, uniqueId, bookId}) => {\r\n              // before the queued fetch request is sent out. Check if the book is still on the shelf. If not, cancel the result altogather.\r\n              console.log('Checking is BookId Is Valid', this.isBookIdValid(bookId))\r\n              if (!this.isBookIdValid(bookId)) { console.log('bookId', bookId, 'no longer existed, drop the request'); return null }\r\n              let result;\r\n              // notify the book that a fetch is starting; here result is yet to be defined\r\n              this.updateFetchResultRepoWithStatus({index, result, status: BookAccessFetchingState.FETCHING})\r\n\r\n              // const url = 'https://www.worldmiao.com/api/scraper/access'\r\n                const url = './api/scraper/access'\r\n              // const url = 'http://localhost:9000/scraper/access'\r\n              const payload = {\r\n                uniqueId\r\n                , provider: this.bookProvider}\r\n              console.log('Sending Request', { index, uniqueId, payload, bookId })\r\n              try {\r\n                result = await this.axios.post(url, payload)\r\n                console.log('inner response received', index, result)\r\n                return {index, result}\r\n              } catch(err) {\r\n                console.log('catched!')\r\n                return {index, result: null}\r\n              }\r\n              // this.axios.post(url, payload).then(result => {\r\n              //   console.log('inner response received', index, result)\r\n              //   return {index, result}\r\n              // }).catch(error => {\r\n              //   console.warn('error', error)\r\n              //   empty()\r\n              // })\r\n              //\r\n            }),\r\n            //\r\n            // catchError((err, caught) => {\r\n            //   console.warn('caught', caught)\r\n            //   console.warn('error', err)\r\n            //   return empty('test')\r\n            // }),\r\n            filter(val => val !== null),\r\n        )\r\n        .subscribe((res) => {\r\n          if (typeof res?.index !== 'number') {\r\n            return\r\n          }\r\n          // if (!res.result) {}\r\n          const {index, result} = res\r\n\r\n          console.log('outter response received', index, result)\r\n          // drop null results.\r\n\r\n          console.log('Received loaded for index,', index, result)\r\n          this.updateFetchResultRepoWithResult({index, result})\r\n        }, () => {console.log('error')},\r\n            () => {\r\n          // in case the fetch failed.\r\n          console.log('completed')\r\n              this.updateFetchResultRepoWithResult(null);\r\n\r\n        })\r\n  },\r\n  unmounted() {\r\n    this.fetchRequestQueueSub?.unsubscribe();\r\n    this.searchAllRequestSub?.unsubscribe();\r\n  },\r\n  data() {\r\n    return {\r\n      boxesShown: false,\r\n      searchStatusShown: false,\r\n      fetchRequestQueue: new Subject(),\r\n      fetchResultRepository: new Subject(),\r\n      fetchRequestQueueSub: undefined,\r\n      searchAllRequestSub: undefined,\r\n    }\r\n  },\r\n  methods: {\r\n    // check a book is still on the shelf. notice if the same book is reloaded from the backend, it will have a different id too.\r\n    isBookIdValid(bookId) {\r\n      console.log(this.bookShelfRef[this.bookProvider])\r\n      return this.bookShelfRef[this.bookProvider].findIndex(box => box.book.id === bookId) > - 1\r\n    }\r\n    ,\r\n    updateFetchResultRepoWithResult(val) {\r\n      val.operation = 'result'\r\n      this.fetchResultRepository.next(val)\r\n    },\r\n    updateFetchResultRepoWithStatus(val) {\r\n      val.operation = 'status'\r\n      this.fetchResultRepository.next(val)\r\n    },\r\n    showBoxes: function() {\r\n      if (!this.boxesShown) {\r\n\r\n        setTimeout(() => this.boxesShown = true, 0)\r\n        setTimeout(() => this.searchStatusShown = true, 0.8)\r\n        this.fillBookShelfWithEmptyBoxes()\r\n        this.boxesShown = true;\r\n        this.searchStatusShown = true;\r\n      }\r\n    },\r\n    hideBoxes: function() {\r\n      console.log('called')\r\n      this.unshelfBooks();\r\n      this.boxesShown = false\r\n    },\r\n    openLink: function(url) {\r\n      if (url?.length < 1) return\r\n      window.open(url)\r\n    },\r\n    onReceiveFetchRequest: function({ index, uniqueId, bookId }) {\r\n      console.log(\"Library put on queue a new fetch request\", { index, uniqueId, bookId })\r\n      this.fetchRequestQueue.next({index, uniqueId, bookId})\r\n    }\r\n\r\n  },\r\n\r\n  watch: {\r\n    bookStore: function() {\r\n      console.log(\"Found Book Store Change\", this.bookStore)\r\n      if (this.bookStore !== undefined) {\r\n        this.upshelfBooks(this.bookStore.data)\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n}\r\n</script>\r\n<style>\r\n#back-panel {\r\n  z-index: 9999\r\n}\r\n#book-shelf {\r\n  z-index: 9999\r\n}\r\n.bookBox {\r\n  -webkit-transition: transform 0.3s ease;\r\n  z-index: 0;\r\n}\r\n.bookBox.moveUpOutOfView{\r\n  transform: translate3d(0, -400px, 0);\r\n  -webkit-transform: translate3d(0, -400px, 0);\r\n  -webkit-transition: transform 0.3s ease;\r\n  z-index: 0\r\n}\r\n</style>\r\n","export enum BookAccessFetchingState {\r\n    IDLE = 'IDLE',\r\n    FETCHING = 'FETCHING',\r\n    QUEUING = 'QUEUING',\r\n    FETCHED = 'FETCHED',\r\n    ERROR = 'ERROR'\r\n}\r\n","\r\n<style>\r\n\r\n.description::-webkit-scrollbar {\r\n  display: none;\r\n\r\n}\r\n.description {\r\n  -ms-overflow-style: none;  /* IE and Edge */\r\n  scrollbar-width: none;  /* Firefox */\r\n}\r\n.library-name-cover {\r\n  color: #3B5957;\r\n  background-color: #5D8D89;\r\n  text-shadow: 0px 1px 0px rgba(255,255,255,.3), 0px -1px 0px rgba(0,0,0,.7);\r\n  font-size: xx-large;\r\n}\r\n\r\n.bookCover {\r\n  -webkit-transition: transform 0.5s ease;\r\n  z-index: 9999;\r\n}\r\n.bookCover.moveUpOutOfView{\r\n  transform: translate3d(0, -400px, 0);\r\n  -webkit-transform: translate3d(0, -400px, 0);\r\n  -webkit-transition: transform 0.5s ease;\r\n}\r\n\r\n\r\n.bookInfo {\r\n  -webkit-transition: transform 0.5s ease;\r\n}\r\n.bookInfo.moveIntoViewFromBelow {\r\n  transform: translate3d(0, -200px, 0);\r\n  -webkit-transform: translate3d(0, -200px, 0);\r\n  -webkit-transition: transform 0.5s ease;\r\n}\r\n.bookInfo.moveUpOutOfView{\r\n  transform: translate3d(0, -400px, 0);\r\n  -webkit-transform: translate3d(0, -400px, 0);\r\n  -webkit-transition: transform 0.5s ease;\r\n}\r\n\r\n.bookLinks {\r\n\r\n  -webkit-transition: transform 0.5s ease;\r\n}\r\n.bookLinks.moveIntoViewFromBelow {\r\n  transform: translate3d(0, -400ox, 0);\r\n  -webkit-transform: translate3d(0, -400px, 0);\r\n  -webkit-transition: transform 0.5s ease;\r\n}\r\n.coverBgColor {\r\n  background-color: #5D8D89;\r\n}\r\n.bookInfoBgColor {\r\n  background-color: #c9dedd;\r\n}\r\n.bookLinksBgColor {\r\n background-color: #f3f3f3;\r\n}\r\n</style>\r\n\r\n<template>\r\n<!--  the back panel 's color is that of the cover so when the cover is lift there is no white color in the back-->\r\n<div\r\n      style=\"max-width: 100%; min-width:200px; max-height:200px; height: 200px;   background-color: #b7d4d2;\"\r\n      class=\"overflow-hidden border \"\r\n>\r\n\r\n<!-- box cover -->\r\n  <div\r\n      style=\"min-height: 200px; height: 200px; background-color: #5D8D89;\"\r\n      :class=\"{'moveUpOutOfView': !bookCoverShown}\"\r\n      class=\"bookCover font-bold grid grid-cols-1 content-between\"\r\n\r\n  >\r\n    <div class=\"cover-header\"></div>\r\n\r\n    <div class=\"library-name-cover cover-content text-lg\">{{libraryName}}</div>\r\n    <div class=\"cover-footer\"></div>\r\n\r\n  </div>\r\n\r\n<!--  Book info card-->\r\n\r\n\r\n<!--  old color: #b7d4d2 -->\r\n  <div\r\n\r\n      @click=\"this.toggleBookInfo()\"\r\n      style=\"min-height: 200px; background-color: #c9dedd\"\r\n\r\n      :class=\"{\r\n        'moveUpOutOfView': !this.state.showInfo,\r\n      'moveIntoViewFromBelow': !bookCoverShown,\r\n      'cursor-pointer': this.beingMaintained === null,\r\n      'cursor-not-allowed': this.beingMaintained !== null,\r\n      }\"\r\n      class=\"bookInfo grid grid-cols-1 content-between \"\r\n\r\n  >\r\n\r\n<!--    Details -->\r\n\r\n<!--   Title -->\r\n    <div style=\"max-height: 55px; min-height: 60px\"\r\n         :title=\"book.title\"\r\n         class=\"\r\n         overflow-truncate\r\n         overflow-y-hidden\r\n\r\n         book-info-title\r\n         text-base\r\n         pl-8  pt-4 pr-6  text-black text-left \">\r\n      <span class=\"font-base\">{{index + 1 + '.'}}</span>\r\n      <span class=\"ml-2 \"\r\n      >{{  book.title }}</span>\r\n    </div>\r\n\r\n<!--  author, year, publisher  -->\r\n    <div class=\"book-info-description grid grid-col-1\">\r\n          <div class=\"text-xs my px-4 truncate my-1  text-gray-600\">\r\n\r\n            <span v-if=\"book?.author\">{{ book?.author + ', ' }}</span>\r\n            <span v-if=\"book?.publicationYear !== 0\">{{ book?.publicationYear}}</span>\r\n            <span v-if=\"book?.publisher\">{{'; ' + book?.publisher}}</span>\r\n\r\n          </div>\r\n\r\n<!--      description -->\r\n      <div\r\n          style=\"\r\n          max-height: 90px;\r\n          text-overflow: ellipsis;\r\n          word-wrap: break-word;\"\r\n\r\n\r\n          class=\"description text-left text-xs text-gray-600  py-2 px-6 mx-4 overflow-y-scroll select-none\"\r\n      >\r\n\r\n        {{book.description}}\r\n\r\n      </div >\r\n\r\n    </div>\r\n<!--    old color: text-gray-500 |-->\r\n    <div\r\n        style=\"color: #668885\"\r\n        class=\"boot-info-footer pb-2\r\n\r\n\r\n    text-xs\">{{libraryName}}</div>\r\n\r\n  <!--  Title -->\r\n\r\n<!--   Author, Publication, Publisher -->\r\n\r\n\r\n<!-- Description\r\n-->\r\n\r\n</div>\r\n\r\n  <!--    Book Link-->\r\n\r\n<div  @click=\"toggleBookInfo()\"\r\n:class=\"{'moveIntoViewFromBelow': !this.state.showInfo && !bookCoverShown }\"\r\n      style=\"background-color: #b7d4d2;\"\r\n      class=\"bookLinks \">\r\n\r\n<BookAccesses\r\n\r\n    :book=\"book\"\r\n    :fetchStatus=\"this.fetchStatus\"\r\n    :accesses=\"accesses\"\r\n    :libraryName=\"libraryName\"\r\n    :links=\"state.links\"/>\r\n\r\n</div>\r\n\r\n</div>\r\n\r\n</template>\r\n<script lang=\"js\">\r\nimport {fetchAccess} from \"@/functions/fetchBookAccess\";\r\nimport {BookAccessFetchingState} from \"@/entities/book.fetch.entity\";\r\nimport {reactive} from \"vue\";\r\nimport BookAccesses from \"@/components/BookAccesses.vue\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {ScrapingCenterSuccessResponse} from \"@/interfaces/ScrapingCenterSuccessResponse\";\r\n\r\n\r\nexport default {\r\n  name: 'VueBook',\r\n  components: {BookAccesses},\r\n  emits: ['fetch-request'],\r\n  setup(props) {\r\n    // console.log(\"Received Book\", book )\r\n    const state = reactive({\r\n      bookAccess: BookAccessFetchingState.IDLE,\r\n      timer: 0,\r\n      links: props.book?.access,\r\n      showInfo: true\r\n    })\r\n\r\n    const fetch = async (test) => {\r\n      state.timer = 0;\r\n      state.bookAccess = BookAccessFetchingState.FETCHING\r\n      fetchAccess(test, state)\r\n    }\r\n\r\n    return {\r\n      fetch,\r\n      state,\r\n\r\n    }\r\n  },\r\n  props: {\r\n    book: Object,\r\n    index: Number,\r\n    bookCoverShown: Boolean,\r\n    libraryName: String,\r\n    fetchResultRepository: Object,\r\n    beingMaintained: String\r\n  },\r\n  data() {\r\n    return {\r\n      accesses: [\r\n      ],\r\n      fetchStatus: BookAccessFetchingState.IDLE,\r\n      fetchTimer: 0,\r\n      fetchResultRepositorySub: undefined\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    resetAllProperties() {\r\n      this.fetchStatus.BookAccessFetchingState.IDLE\r\n    },\r\n    hasNeedToFetch() {\r\n      // console.log('check if need to fetch', this.accesses)\r\n      return this.accesses.length === 0;\r\n    }\r\n    ,\r\n    onFetchAccess: async function (uniqueId, provider) {\r\n      if (!uniqueId || !provider) {\r\n        throw new Error('invalid fetch')\r\n      }\r\n      if (!this.hasNeedToFetch())\r\n      {\r\n        console.log('no need to fetch has ', this.accesses.length)\r\n        return\r\n      }\r\n\r\n      console.log('need to fetch check', this.hasNeedToFetch())\r\n      console.log(\"Fetch Access\")\r\n\r\n\r\n      this.makeFetchRequest(uniqueId, provider)\r\n    },\r\n    makeFetchRequest(index, uniqueId, bookId) {\r\n      this.fetchStatus = BookAccessFetchingState.QUEUING\r\n      this.$emit('fetch-request', { index, uniqueId, bookId })\r\n    },\r\n\r\n    toggleBookInfo: function() {\r\n      console.log('Checking maintainance status', this.beingMaintained)\r\n      if (this.beingMaintained !== null) {\r\n        console.log(this.beingMaintained)\r\n        return\r\n      }\r\n      // switch to the other view\r\n      this.state.showInfo = !this.state.showInfo\r\n      // is the view that is switched to is links and the state is IDLE, start fetching\r\n      if (!this.state.showInfo && this.fetchStatus === BookAccessFetchingState.IDLE) {\r\n        // use book's unique id to fetch access\r\n        // this.onFetchAccess(this.book.uniqueIdentifier.id, this.book.provider)\r\n        if (!this.hasNeedToFetch()) {\r\n          console.log('no need to fetch has ', this.accesses.length)\r\n          return\r\n        }\r\n        this.makeFetchRequest(this.index, this.book.uniqueIdentifier.id, this.book.id)\r\n      }\r\n\r\n}\r\n  },\r\n  mounted() {\r\n    // function to receive fetched access or fetch status update\r\n    this.fetchResultRepositorySub = this.fetchResultRepository.subscribe(({index, result, operation, status}) => {\r\n      if (index === this.index) {\r\n\r\n        switch (operation) {\r\n          case 'status':\r\n            this.fetchStatus = status\r\n            break\r\n          case 'result':\r\n            console.log('Child', this.index, 'received repo update', result)\r\n            this.fetchStatus = BookAccessFetchingState.FETCHED;\r\n            // if result is null. it means the fetch failed and since the status is already fetched. it will show no links found.\r\n            if (result?.data?.data) {\r\n              this.accesses = result.data.data;\r\n            }\r\n            break\r\n        }\r\n\r\n      }\r\n    })\r\n  },\r\n  unmounted() {\r\n    this.fetchResultRepositorySub?.unsubscribe();\r\n  },\r\n\r\n  watch: {\r\n    book: function() {\r\n      // if book is loaded, reset showInfo To True\r\n      // console.log(\"FOUND BOOK CHANGED\", this.book)\r\n      this.state.showInfo = true\r\n      // load book access and reset loading state\r\n      this.accesses = this.book.access\r\n      this.fetchStatus = BookAccessFetchingState.IDLE\r\n    }\r\n  }\r\n\r\n\r\n}\r\n</script>\r\n","import {BookAccessFetchingState} from \"@/entities/book.fetch.entity\";\r\n\r\nexport const fetchAccess = (identifier: string, state: {bookAccess: BookAccessFetchingState, timer: number}) => {\r\n    state.bookAccess = BookAccessFetchingState.FETCHING\r\n    console.log(\"fetching id \", identifier)\r\n    let interval = setInterval(() => {\r\n        state.timer++\r\n        console.log(state.timer)\r\n    }, 1000)\r\n\r\n    let elapse = setTimeout(() =>\r\n    {\r\n        state.bookAccess = BookAccessFetchingState.FETCHED\r\n        clearInterval(interval)\r\n    }, 5000);\r\n\r\n\r\n\r\n}\r\n","<style>\r\n.displaygrid::-webkit-scrollbar {\r\n  display: none;\r\n\r\n}\r\n.displaygrid {\r\n  -ms-overflow-style: none;  /* IE and Edge */\r\n  scrollbar-width: none;  /* Firefox */\r\n}\r\n</style>\r\n<template>\r\n\r\n\r\n    <div style=\"height:200px; background-color: #fffffc !important;\"\r\n         class=\"grid  grid-cols-12 content-between cursor-pointer\">\r\n\r\n      <div :title=\"book.title\"\r\n\r\n\r\n           id=\"access-header\" style=\"max-height: 60px; min-height: 60px; color: #668885\"  class=\" overflow-y-hidden col-span-12 pt-4 px-4\">\r\n        <span @click.stop class=\"cursor-text\">{{book.title}}</span></div>\r\n\r\n    <div class=\"displaygrid space-y-2 col-span-12 content-between overflow-y-scroll  grid-cols-12\">\r\n      <!--   Display Panel for direct links. -->\r\n\r\n\r\n      <!--  show fetching    -->\r\n      <div v-if=\"fetchStatus === 'FETCHING' || fetchStatus === 'QUEUING'\"\r\n           class=\"text-xs col-span-12 cursor-wait \"\r\n\r\n      >\r\n        <span >{{getStatusString}}</span>\r\n      </div>\r\n\r\n      <!--   show no result   -->\r\n\r\n      <div v-if=\"(fetchStatus === 'FETCHED' || fetchStatus === 'ERROR') && accesses?.length === 0 \"\r\n           class=\"text-xs col-span-12  h-full\"\r\n      >\r\n        <span class=\"cursor-not-allowed\">no links found.</span>\r\n      </div>\r\n\r\n      <!-- show results -->\r\n<!--      <div v-for=\"(access, index) in accesses\" :key=\"index\" class=\"col-span-12 grid grid-cols-12 pl-2 \">-->\r\n        <div v-for=\"(access, index) in accesses\" :key=\"index\" class=\"col-span-12 grid grid-cols-12 pl-2 \">\r\n\r\n          <div\r\n              :title=\"`${access.type}. some might require login`\"\r\n              id=\"data-access-type\" v-if=\"access.type\"\r\n              class=\"\r\n              col-span-3\r\n              text-xs\r\n              access-type\r\n              truncate\r\n              text-right\r\n              cursor-pointer\r\n              \"\r\n          >\r\n            {{index + 1}}: {{getAccessTypeString(access.type)}}:\r\n          </div>\r\n        <div\r\n              :title=\"access.link\"\r\n              class=\"text-xs   truncate pl-2 pr-4 col-span-9  text-center\">\r\n          <div  class=\"truncate\" >\r\n            <span @click.stop.prevent=\"openWindow(access.link)  \" class=\"cursor-pointer hover:underline\">{{getDisplayString(access)}}</span>\r\n          </div>\r\n<!--          -->\r\n<!--          <div class=\"truncate \" v-if=\"access.type === dataType.DATABASE\">-->\r\n<!--            <span @click.stop.prevent=\"openWindow(access.link)  \" class=\"cursor-pointer hover:underline\">{{access.name}}</span>-->\r\n<!--          </div>-->\r\n<!--        </div>-->\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n    </div>\r\n    <div id=\"access-footer\"\r\n         style=\"color: #668885\"\r\n         class=\"  col-span-12 pb-2 text-xs\"><span>\r\n      {{libraryName}}\r\n      </span></div>\r\n\r\n  </div>\r\n\r\n</template>\r\n<script lang=\"js\">\r\n\r\n\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nimport {Book, BookAccess, BookAccessType, BookDataType} from \"@/entities/book.entity\";\r\nimport {BookAccessFetchingState} from \"@/entities/book.fetch.entity\";\r\n\r\nexport default {\r\n  name: 'BookAccesses',\r\n  props: {\r\n    links: Array,\r\n    book: Object,\r\n    accesses: Array,\r\n    fetchStatus: BookAccessFetchingState,\r\n    libraryName: String\r\n  },\r\n  methods: {\r\n    openWindow: (link) => window.open(link),\r\n    getAccessTypeString: function(accessType) {\r\n      if (!accessType) return;\r\n      let string = ''\r\n      switch (accessType) {\r\n        case BookAccessType.DATABASE:\r\n          string = 'database'\r\n          break;\r\n        default:\r\n          string = accessType.toLowerCase();\r\n          break;\r\n      }\r\n      return string;\r\n    },\r\n    getDisplayString: function (access) {\r\n      if (access) {\r\n        return access.name.length > 0 ? access.name : access.link\r\n      }\r\n      return ''\r\n    }\r\n  },\r\n  computed: {\r\n    getStatusString: function() {\r\n      let string = ''\r\n      switch (this.fetchStatus) {\r\n        case BookAccessFetchingState.FETCHING:\r\n          string = 'fetching links ...'\r\n          break\r\n        case BookAccessFetchingState.QUEUING:\r\n          string = 'queuing ..'\r\n          break\r\n      }\r\n      return string;\r\n    },\r\n\r\n  },\r\n  data() {\r\n    return {\r\n      dataType: BookAccessType\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./BookAccesses.vue?vue&type=template&id=21022ed4\"\nimport script from \"./BookAccesses.vue?vue&type=script&lang=js\"\nexport * from \"./BookAccesses.vue?vue&type=script&lang=js\"\n\nimport \"./BookAccesses.vue?vue&type=style&index=0&id=21022ed4&lang=css\"\nscript.render = render\n\nexport default script","import { render } from \"./VueBook.vue?vue&type=template&id=25178b2b\"\nimport script from \"./VueBook.vue?vue&type=script&lang=js\"\nexport * from \"./VueBook.vue?vue&type=script&lang=js\"\n\nimport \"./VueBook.vue?vue&type=style&index=0&id=25178b2b&lang=css\"\nscript.render = render\n\nexport default script","import {Book, BookProvider} from \"@/entities/book.entity\";\r\n\r\nexport type SearchStore  = Record<BookProvider, SearchStatus>\r\n\r\nexport class BookShelfBox {\r\n\r\n    bookCoverShown = true // the default value determines whether cover is down in the beginning\r\n    book = new Book(null)\r\n}\r\n\r\nexport type BookShelf = Record<BookProvider, BookShelfBox[]>\r\n\r\nexport class SearchStatus {\r\n    set searchingStatus(value: LibrarySearchStatus) {\r\n        switch(value) {\r\n            case LibrarySearchStatus.ERROR:\r\n                this.stopTimer()\r\n                break;\r\n            case LibrarySearchStatus.SEARCHING:\r\n                this.resetTimer()\r\n                this.startTimer()\r\n                break;\r\n            case LibrarySearchStatus.SEARCH_FINISHED:\r\n                this.stopTimer()\r\n                break;\r\n        }\r\n        this._searchingStatus = value;\r\n    }\r\n    setSearchedTerm(term: string) {\r\n        this.searchedTerm = term;\r\n    }\r\n    getSearchedTerm(): string {\r\n        return this.searchedTerm\r\n    }\r\n    searchedTerm: string = ''\r\n    searchResultCount: number | null = null;\r\n    provider: BookProvider\r\n    private _searchingStatus: LibrarySearchStatus = LibrarySearchStatus.IDLE\r\n    private intervalTimer: number = 0;\r\n    searchTimer: number = 0;\r\n    constructor(provider: BookProvider) {\r\n        this.provider = provider\r\n    }\r\n\r\n    getTimerValue() {\r\n        return (this.searchTimer / 10).toFixed(1);\r\n    }\r\n\r\n    getCurrentStatus() {\r\n        return this._searchingStatus\r\n    }\r\n\r\n    setSearchResultCount(count: number) {\r\n        console.log('hit', count)\r\n        if (typeof count === 'number') {\r\n            this.searchResultCount = count\r\n        }\r\n    }\r\n\r\n    getSearchResultCount() {\r\n        if (this.searchResultCount !== undefined) {\r\n            return this.searchResultCount\r\n        }\r\n    }\r\n    setSearchStatus(status: LibrarySearchStatus) {\r\n        this.searchingStatus = status\r\n    }\r\n    startTimer() {\r\n        this.intervalTimer = setInterval(() => {this.searchTimer++}, 100)\r\n    }\r\n\r\n    stopTimer() {\r\n        clearInterval(this.intervalTimer)\r\n    }\r\n\r\n    resetTimer() {\r\n        this.stopTimer()\r\n        this.searchTimer = 0;\r\n    }\r\n}\r\n\r\nexport enum LibrarySearchStatus {\r\n    SEARCH_FINISHED = \"done.\",\r\n    IDLE = 'ready.',\r\n    SEARCHING = 'searching...',\r\n    ERROR = 'error.'\r\n}\r\n","import { render } from \"./Library.vue?vue&type=template&id=8ee0a016\"\nimport script from \"./Library.vue?vue&type=script&lang=js\"\nexport * from \"./Library.vue?vue&type=script&lang=js\"\n\nimport \"./Library.vue?vue&type=style&index=0&id=8ee0a016&lang=css\"\nscript.render = render\n\nexport default script","<style>\r\n/*.search-input::-webkit-search-cancel-button{*/\r\n/*  position:relative;*/\r\n/*  left:0px;*/\r\n/*  !*-webkit-appearance: searchfield-cancel-button;*!*/\r\n/*  !*border-radius:10px;*!*/\r\n/*  !*background: #3B5957;*!*/\r\n/*}*/\r\n\r\n.checkbox {\r\n  display: inline-flex;\r\n  position: relative;\r\n}\r\n.searchall_active {\r\n  color: #5d8d89;\r\n}\r\n.checkbox > span {\r\n  color: #34495E;\r\n\r\n}\r\n\r\n.checkbox > input {\r\n  height: 18px;\r\n  width: 18px;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n  -o-appearance: none;\r\n  appearance: none;\r\n  border-radius: 10px;\r\n  outline: none;\r\n  transition-duration: 0.1s;\r\n  background-color: #e5e7eb;\r\n  border: 1px solid #afc1c1;\r\n  cursor: pointer;\r\n}\r\n\r\n.checkbox > input:checked {\r\n  border: 5px solid #e5e7eb;\r\n  background-color: #5d8d89;\r\n}\r\n\r\n.checkbox > input:checked + span::before {\r\n  content: '\\2713';\r\n  display: block;\r\n  text-align: center;\r\n  color: #e5e7eb;\r\n  position: absolute;\r\n  left: 0.7rem;\r\n  top: 0.2rem;\r\n}\r\n\r\n.checkbox > input:active {\r\n  border: 2px solid #3B5957;\r\n}\r\n</style>\r\n<template>\r\n<!--  <span>&nbsp;<span v-if=\"!inputIsEmpty()\"-->\r\n<!--      @click=\"clearInput()\"-->\r\n<!--         class=\"pr-2 text-gray-600 cursor-pointer\">clear</span></span>-->\r\n\r\n  <div class=\"grid grid-cols-1\">\r\n    <div>\r\n  <label>\r\n    <input style=\" background-color: transparent; min-width: 100px; width: 200px\"\r\n           maxlength=\"90\"\r\n           class=\"search-input px-1 outline-none text-black border-b text-xs\"\r\n           type=\"search\" :value=\"searchTerm\"\r\n           @keyup.enter=\"makeSearchRequest\"\r\n           @input=\"emitSearchTermChanges($event.target.value)\"\r\n\r\n    />\r\n    <span :class=\"{'text-gray-200': this.searchTerm.length <= this.searchInputMinLength, 'hover:underline': this.searchTerm > this.searchInputMinLength}\"\r\n          class=\"pl-2 cursor-pointer text-black hover:underline outline-none select-none\"\r\n          style=\"color: #5d8d89\"\r\n          @click=\"makeSearchRequest\">search...</span>\r\n  </label>\r\n\r\n\r\n\r\n    </div>\r\n\r\n<!-- search all checkbox-->\r\n    <div v-show=\"!isRequestValid()\" class=\"text-center\">&nbsp;<span  v-if=\"isInputTooShort()\" class=\"text-red-400 text-xs\" >* too short</span></div>\r\n    <div v-show=\"isRequestValid()\" class=\"checkbox-div  select-none\" >\r\n      <div style=\"width: 205px; \" class=\" inline-block\">&nbsp;</div>\r\n      <div class=\"inline-block\" >\r\n      <label class=\"checkbox hover:underline\" title=\"check to search all libraries\">\r\n        <input type=\"checkbox\" :checked=\"searchAll\" @change=\"toggleSearchAll($event.target.checked)\">\r\n        <div\r\n            class=\" inline-block pl-2 cursor-pointer  text-base mr-4\"\r\n            :class=\"{ 'searchall_active': searchAll, 'text-gray-400': !searchAll}\"\r\n        >all</div>\r\n      </label>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n</template>\r\n<script lang=\"js\">\r\nimport { Subject, interval, merge } from 'rxjs';\r\nimport {debounce, first, skip} from 'rxjs/operators'\r\nexport default {\r\n  name: 'SearchBox',\r\n  emits: ['update:searchTerm', 'searchRequest', 'onSearchAll'],\r\n  props: {\r\n    searchTerm: String,\r\n    hideSearchButton: Boolean,\r\n    libraryName: String,\r\n    bookProvider: String,\r\n    searchAll: Boolean,\r\n    searchInputMinLength: Number\r\n  },\r\n\r\n  mounted() {\r\n    this.searchDeboucerSub = merge(\r\n    this.requestEmitter.pipe(first()),\r\n    this.requestEmitter.pipe(\r\n        skip(1),\r\n        debounce(() => interval(800)\r\n        ))\r\n    )\r\n        .subscribe((provider) => {\r\n      console.log(\"Emiting a request after interval\")\r\n      this.$emit('searchRequest', provider)\r\n    this.grayOutSearch = false\r\n\r\n    })\r\n  },\r\n\r\n  unmounted() {\r\n    this.searchDeboucerSub?.unsubscribe()\r\n  },\r\n  methods: {\r\n    emitSearchTermChanges(value)  {\r\n      this.localSearchString = value;\r\n      console.log(\"Emitting Change\")\r\n\r\n      this.$emit('update:searchTerm', value)\r\n    },\r\n    makeSearchRequest() {\r\n      if (this.searchTerm.length <= this.searchInputMinLength) {return}\r\n      this.grayOutSearch = true\r\n      this.requestEmitter.next(this.bookProvider)\r\n    },\r\n    // check if the search input is valid\r\n    isRequestValid() {\r\n      return this.localSearchString?.trim().length > this.searchInputMinLength || this.searchTerm?.trim().length > this.searchInputMinLength\r\n    },\r\n    isInputTooShort() {\r\n      return (this.localSearchString?.trim().length > 0 && this.localSearchString?.trim().length <= this.searchInputMinLength) || (this.searchTerm?.trim().length > 0 && this.searchTerm?.trim().length <= this.searchInputMinLength)\r\n    },\r\n    clearInput() {\r\n      this.localSearchString = '';\r\n      this.emitSearchTermChanges('');\r\n    },\r\n    inputIsEmpty() {\r\n      return !this.localSearchString && !this.searchTerm\r\n    },\r\n    toggleSearchAll(searchAllChecked) {\r\n      this.$emit('onSearchAll', searchAllChecked)\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      requestEmitter: new Subject(),\r\n      requestWatcher: null,\r\n      localSearchString: '',\r\n      searchDeboucerSub: undefined\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./SearchBox.vue?vue&type=template&id=ee7545b8\"\nimport script from \"./SearchBox.vue?vue&type=script&lang=js\"\nexport * from \"./SearchBox.vue?vue&type=script&lang=js\"\n\nimport \"./SearchBox.vue?vue&type=style&index=0&id=ee7545b8&lang=css\"\nscript.render = render\n\nexport default script","<style>\r\n.greendone {\r\n  color: #5d8d89;\r\n}\r\n\r\n\r\n</style>\r\n<template>\r\n\r\n  <div class=\"grid grid-cols-8 text-xs \">\r\n<!--  search term record  -->\r\n    <div class=\" text-center col-span-8  truncate px-4\">\r\n      <span\r\n          v-if=\"getSearchTerm.length > 0\"\r\n          title=\"reuse this search term\"\r\n          @click=\"reuseSearchTerm()\"\r\n          class=\"cursor-pointer hover:underline \">\r\n        {{getSearchTerm}}\r\n      </span>\r\n<!--    filler  -->\r\n      <span\r\n          v-if=\"!(getSearchTerm.length > 0)\"\r\n          class=\"cursor-default\">\r\n        &nbsp;\r\n      </span>\r\n<!---->\r\n    </div>\r\n\r\n    <div\r\n        class=\"status col-span-3 text-right text-gray-700\"\r\n        :class=\"{\r\n      'done greendone': searchStore[bookProvider].getCurrentStatus() === librarySearchStatus.SEARCH_FINISHED ,\r\n      'text-red-400': searchStore[bookProvider].getCurrentStatus() === librarySearchStatus.SEARCHING\r\n        }\"\r\n    >\r\n      &nbsp;{{searchStore[bookProvider].getCurrentStatus()}}\r\n    </div>\r\n\r\n<!--  filler  -->\r\n    <div\r\n        v-if=\"searchStore[bookProvider].getCurrentStatus() !== librarySearchStatus.SEARCH_FINISHED\"\r\n        class=\"result-count col-span-2 text-center text-gray-700\"\r\n    >\r\n      &nbsp;\r\n    </div>\r\n<!-- /filler  -->\r\n    <div\r\n        v-if=\"searchStore[bookProvider].getCurrentStatus() === librarySearchStatus.SEARCH_FINISHED\"\r\n        class=\"result-count col-span-2 text-center text-gray-700\"\r\n    >\r\n      {{getSearchResultCount}}\r\n\r\n    </div>\r\n    <div class=\"text-center col-span-1 overflow-visible text-gray-700 \"\r\n         id=\"search-timer\">{{getSearchTime}}</div>\r\n\r\n<!--  button to close bookshelf  -->\r\n    <div v-if=\"!shelfIsEmpty\" title=\"close results\" @click=\"closeBookShelf()\"\r\n         class=\" col-span-2 text-right pr-2 \"\r\n    >\r\n      <span class=\"cursor-pointer hover:underline\">[ x ]</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"js\">\r\n// eslint-disable-next-line no-unused-vars\r\nimport {BookProvider} from \"@/entities/book.entity\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {LibrarySearchStatus, SearchStore} from \"@/entities/app.entity\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {BookStore} from \"@/interfaces/AppProps\";\r\n\r\nexport default {\r\n  name: 'SearchStatusPanel',\r\n  props: ['bookStore', 'searchStore', 'bookProvider', 'closeBookshelfHandler', 'shelfIsEmpty'],\r\n  emits: ['close-bookshelf', 'reuse-search-term'],\r\n  setup(props) {\r\n    console.log(props)\r\n    const timer = props.searchStore[props.bookProvider].getTimerValue();\r\n    const status = props.searchStore[props.bookProvider].getCurrentStatus();\r\n    const statusString = props.bookProvider + timer;\r\n    return {\r\n      statusString,\r\n      timer,\r\n      status\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      librarySearchStatus: LibrarySearchStatus\r\n    }\r\n  },\r\n  computed: {\r\n    getSearchTerm() {\r\n      if (this.searchStore[this.bookProvider].getSearchedTerm()) {\r\n        return `\"${this.searchStore[this.bookProvider].getSearchedTerm()}\"`;\r\n      }\r\n      return ''\r\n\r\n    },\r\n    getSearchTime() {\r\n      return this.searchStore[this.bookProvider].getTimerValue() + 's';\r\n    },\r\n    getSearchResultCount() {\r\n      // console.log(\"CALCULATING COUNT\", this.searchStore[this.bookProvider].getSearchResultCount())\r\n      if (this.searchStore[this.bookProvider].getSearchResultCount() === 0) {\r\n        return '(0 hits.)'\r\n      } else {\r\n        return `(${this.searchStore[this.bookProvider].getSearchResultCount()} hits.)`\r\n      }\r\n\r\n      // return + ' hits.';\r\n      }\r\n  },\r\n  methods: {\r\n    closeBookShelf: function() {\r\n      console.log('emitted')\r\n      this.$emit('close-bookshelf', true)\r\n\r\n      // this.closeBookshelfHandler();\r\n    },\r\n    reuseSearchTerm: function() {\r\n      this.$emit('reuse-search-term', this.bookProvider, this.getSearchTerm?.replace(/\"/g, ''))\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./SearchStatusPanel.vue?vue&type=template&id=795a8162\"\nimport script from \"./SearchStatusPanel.vue?vue&type=script&lang=js\"\nexport * from \"./SearchStatusPanel.vue?vue&type=script&lang=js\"\n\nimport \"./SearchStatusPanel.vue?vue&type=style&index=0&id=795a8162&lang=css\"\nscript.render = render\n\nexport default script","\r\n\r\n\r\nimport {Book, BookProvider, BookProviderList} from \"@/entities/book.entity\";\r\nimport {defineComponent} from \"vue\";\r\nimport {reactive} from \"vue\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {AppProps, BookStore} from \"@/interfaces/AppProps\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {ScrapingCenterSuccessResponse} from \"@/interfaces/ScrapingCenterSuccessResponse\";\r\nimport Library from \"@/components/Library.vue\";\r\nimport SearchBox from \"@/components/SearchBox.vue\";\r\nimport SearchStatusPanel from \"@/components/SearchStatusPanel.vue\";\r\n// eslint-disable-next-line no-unused-vars\r\nimport {LibrarySearchStatus, SearchStatus, SearchStore} from \"@/entities/app.entity\";\r\nimport { v4 } from 'uuid';\r\nimport { Subject } from 'rxjs'\r\nexport default defineComponent({\r\n  name: 'App',\r\n  setup(){\r\n\r\n    const state = reactive({\r\n      searchTerm: '',\r\n      searchAll: false\r\n\r\n\r\n    } as AppProps);\r\n    const bookProviderList = BookProviderList\r\n    return {\r\n      bookProviderList,\r\n      state\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      suggestionContent: '',\r\n      suggestionSent: false,\r\n      suggestionFocused: false,\r\n      bookProvider: BookProvider,\r\n      libraryOrder: [\r\n      ],\r\n      searchStore: {\r\n        GOOGLE_BOOKS: new SearchStatus(BookProvider.GOOGLE_BOOKS),\r\n        MEMORY_OF_THE_WORLD: new SearchStatus(BookProvider.MEMORY_OF_THE_WORLD),\r\n        LIBRARY_GENESIS: new SearchStatus(BookProvider.LIBRARY_GENESIS),\r\n        OPEN_LIBRARY: new SearchStatus(BookProvider.OPEN_LIBRARY),\r\n        WORLD_CAT: new SearchStatus(BookProvider.WORLD_CAT),\r\n        ZLIBRARY: new SearchStatus(BookProvider.ZLIBRARY),\r\n        GUTENBERG: new SearchStatus(BookProvider.GUTENBERG),\r\n        PROLETARIAT: new SearchStatus(BookProvider.PROLETARIAT),\r\n      } as SearchStore\r\n      ,\r\n      bookStore: {\r\n        GOOGLE_BOOKS: {\r\n          // data: new Array(20)\r\n        },\r\n        MEMORY_OF_THE_WORLD: {},\r\n        LIBRARY_GENESIS: {},\r\n        OPEN_LIBRARY: {},\r\n        WORLD_CAT: {},\r\n        ZLIBRARY: {},\r\n        PROLETARIAT: {},\r\n        GUTENBERG: {}\r\n      } as BookStore\r\n      ,\r\n      showAllLibraryBoxes: new Subject(),\r\n      // to check if the current search all request is updated and drop the old one in the process.\r\n      currentSearchAllRequestId: '',\r\n      searchInputMinLength: 1\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    test() {\r\n      console.log(\"app.vue received close bookshelf\")\r\n    },\r\n    onSearchRequest: async function (globalProvider: BookProvider) {\r\n      // check if need to search all libraries\r\n      if (this.state.searchAll) {\r\n        this.searchAll()\r\n      } else {\r\n        this.sendSearchRequest(globalProvider)\r\n      }\r\n    },\r\n    searchAll: async function() {\r\n      // if so, show all library boxes first\r\n      this.bookProviderList.forEach((provider) => {\r\n        this.showAllLibraryBoxes.next(provider.providerEnum);\r\n      })\r\n\r\n      // generate an uuid for the current search all request, and save it globally;\r\n      const uniqueSearchAllRequestId = v4();\r\n      this.currentSearchAllRequestId = uniqueSearchAllRequestId;\r\n\r\n\r\n      for await (const providerEntry of this.bookProviderList) {\r\n        // when the global current search id doesn't match local search id, break out of the loop.\r\n        if (this.currentSearchAllRequestId !== uniqueSearchAllRequestId) {\r\n          break;\r\n        }\r\n        await this.sendSearchRequest(providerEntry.providerEnum, uniqueSearchAllRequestId)\r\n      }\r\n    }\r\n    ,\r\n    sendSearchRequest: async function(provider: BookProvider, uniqueSearchAllRequestId?: string) {\r\n      const { searchTerm } = this.state;\r\n      // const url = 'https://www.worldmiao.com/api/scraper/'\r\n      const url = './api/scraper';\r\n      // const url = 'http://localhost:9000/scraper';\r\n\r\n      console.log(\"Posting your request for \", provider, 'for term', searchTerm, \" to\", url)\r\n      // update search status\r\n      this.setSearchStatus(provider, LibrarySearchStatus.SEARCHING)\r\n      this.setSearchTerm(provider, searchTerm);\r\n\r\n      // sending http request\r\n      const {data} = await this.axios.post<ScrapingCenterSuccessResponse>(url, {title:searchTerm, provider})\r\n      if (!data) {\r\n        this.setSearchStatus(provider, LibrarySearchStatus.ERROR)\r\n      }\r\n\r\n      console.log(`Received Response From Server for ${provider}, for term ${searchTerm}, data:`, data)\r\n\r\n      if (uniqueSearchAllRequestId && this.currentSearchAllRequestId !== uniqueSearchAllRequestId) {\r\n        console.log('batch search request dropped, drop the fetched data')\r\n        return\r\n      }\r\n\r\n      const revivedBooks = (data as ScrapingCenterSuccessResponse).data.map(item => Object.assign(new Book(provider), item))\r\n      data.data = revivedBooks;\r\n      this.bookStore[provider] = {...data};\r\n\r\n      this.setSearchStatus(provider, LibrarySearchStatus.SEARCH_FINISHED)\r\n      this.setSearchResultCount(provider, data?.data?.length)\r\n      return\r\n    },\r\n    setSearchStatus: function(provider: BookProvider, searchStatus: LibrarySearchStatus)  {\r\n       this.getSearchStatus(provider).setSearchStatus(searchStatus)\r\n    },\r\n\r\n    setSearchTerm: function (provider: BookProvider, searchTerm: string) {\r\n      this.getSearchStatus(provider).setSearchedTerm(searchTerm)\r\n    },\r\n    getSearchStatus: function(provider: BookProvider) {\r\n       return this.searchStore[provider]\r\n    },\r\n    setSearchResultCount: function(provider: BookProvider, count: number) {\r\n\r\n      this.getSearchStatus(provider).setSearchResultCount(count)\r\n    },\r\n    onReuseSearchTerm:function(provider: BookProvider, searchTerm: string) {\r\n\r\n\r\n      console.log('On Reuse Search Term', provider, searchTerm)\r\n      // this.setSearchTerm(provider, searchTerm)\r\n      this.state.searchTerm = searchTerm\r\n    },\r\n    onSearchAll: function(isSearchAllChecked: boolean) {\r\n      console.log('parent received isSearchALl Checked', isSearchAllChecked)\r\n      this.state.searchAll = isSearchAllChecked\r\n    },\r\n    makeSuggestion: async function () {\r\n      if (this.suggestionContent.length > this.searchInputMinLength) {\r\n        // const url = 'http://localhost:9000/suggestion';\r\n        const url = './api/suggestion';\r\n        console.log('sending suggestion to back end', this.suggestionContent, url)\r\n        this.suggestionSent = false\r\n        const res = await this.axios.post(url, {content: this.suggestionContent})\r\n        console.log(res)\r\n        // if suggestion submission is successful\r\n        if (res.status === 201) {\r\n          this.suggestionSent = true\r\n          this.suggestionContent = ''\r\n        }\r\n      }\r\n    },\r\n    onSuggestionInputFocused() {\r\n\r\n        this.suggestionFocused = true\r\n        this.suggestionSent = false\r\n\r\n    }\r\n    },\r\n  components: {\r\n    Library,\r\n    SearchBox,\r\n    SearchStatusPanel\r\n  }\r\n})\r\n","import { render } from \"./App.vue?vue&type=template&id=7fb97475\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=7fb97475&lang=css\"\nscript.render = render\n\nexport default script","import {createApp} from 'vue'\r\n\r\nimport App from './App.vue'\r\n\r\n\r\n\r\n// @ts-ignore\r\nimport * as axios from 'axios';\r\nimport './index.css'\r\nimport VueAxios from \"vue-axios\";\r\n\r\n\r\n// @ts-ignore\r\ncreateApp(App)\r\n    .use(VueAxios, axios)\r\n\r\n    .mount('#app')\r\n\r\n\r\n// console.log(\"Console.log is enabled: \", process.env.VUE_APP_CONSOLE_ENABLED)\r\nif (process.env.VUE_APP_CONSOLE_ENABLED !== 'true') {\r\n    console.log = function () {};\r\n} else {\r\n    console.log('book search api:', process.env.VUE_APP_SEARCH_API)\r\n    console.log('book fetch api:', process.env.VUE_APP_FETCH_API)\r\n}\r\n\r\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./App.vue?vue&type=style&index=0&id=7fb97475&lang=css\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./SearchStatusPanel.vue?vue&type=style&index=0&id=795a8162&lang=css\"","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"b8cfef10690317b01a13.worker.js\");\n};"],"sourceRoot":""}